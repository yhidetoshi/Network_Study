#### Chapter10 ハイブリッドルーティング
- **内容**
  - **EIGRPの概要**
  - **EIGRPの基本設定と検証**
  - **EIGRPのオプション設定**
  - **EIGRPのトラブルシューティング**
  - **EIGRP for IPv6**


- **EIGRP**
  - シスコ独自
  - ディスタンスベクター型ルーティングプロトコル
  - デュアルアルゴリズムを使用し、超高速コンバージェンスを実現
  - 定期的なアップデートは行わず、トポロジ変更時に部分的なアップデートをマルチキャストやユニキャストで送信
  - 等コスト及び、不等コストのロードバランシング
  - 自動経路集約及び手動経路情報をサポート
  - クラスレスルーティングプロトコルで、VLSMをサポート
  - 複数のネットワーク層プロトコル(IP,IPX, AppleTalk)をサポート
  - 大規模ネットワークで使用できる
  - AS間のルーティングで使用されるプロトコルはBGP

**[EIGRPルータが持つテーブル]**

|パラメータ  |説明         |
|:-----------|:------------|
|ネイバーテーブル|ネイバー関係を確立したEIGRPルータのリスト|
|トポロジーテーブル|ネイバーから受信した全ての経路情報を格納|
|ルーティングテーブル|実際のルーティングで使用される最適経路のリスト|


**[EIGRPのメトリック]**

|種類  |説明         |
|:-----------|:------------|
|帯域幅|ローカルルータと宛先ネットワーク間の最小帯域|
|遅延|ローカルルータと宛先ネットワーク間の蓄積インタフェース遅延|

上の表以外のメトリックを追加設定できる


|種類  |説明         |
|:-----------|:------------|
|信頼性|ローカルルータと宛先ネットワーク間の最小の信頼性|
|負荷|ローカルルータと宛先ネットワーク間のリンク上で最大の負荷|
|MTU|ローカルルータと宛先ネットワーク間の最小MTU|

-> 信頼性と負荷をメトリックに追加すると、トポロジーの再計算の頻度が高くなるので使用するのは推奨されていない

[まとめ]
- EIGRPデフォルトでは帯域幅と遅延で最適経路を決定する
- 帯域幅の広い経路のメトリック値は小さくなる(最適経路)
- 等コストと不等コストのロードバランシングをサポート
- デフォルトは等コストロードバランシングを行う
- 最小メトリックの経路が複数ある場合、デフォルトは4つまでルーティングテーブルに登録
- T1の帯域幅は1.54Mbps
- マルチキャストアドレス: `224.0.0.10`


**[EIGRPのデフォルトアドミニストレーティブディスタンス値]**

|ルートタイプ|デフォルト値 |説明 |
|:-----------|:------------|-------------|
|EIGRP集約ルート|5| EIGRPで集約されたルート|
|EIGRP内部ルート|90| EIGRPでアドバタイズされた通常のルート|
|EIGRP外部ルート|170|再配送によってEIGRPのルート情報に変換されたルート|


- EIGRPパケット
  - EIGRPで使用されるパケットは、受信時に確認応答が必要な**高信頼性パケット**と確認応答が不要な**無信頼性のパケット**に分類される 
  - 高信頼性
    - `アップデート`: ルーティングアップデートを送信.ルート変更時は差分で通知
    - `クエリ`: ネイバーにルーティング情報を問い合わせる
    - `応答`: クエリに対するルーティング情報の応答
  - 無信頼性
    - `Hello`: ネイバー関係の確立及び、維持
    - `Ack`: 高信頼性パケットを受信した際に送信する確認応答

- EIGRPルータ間でネイバー関係を確立するための項目(ネイバ同士で一致している必要あり)
  - AS番号
  - K値(EIGRPがメトリック計算に使用する重みつけ係数のこと)

- EIGRPの**DUAL**(Diffusing Update Algorithm)
  - **サクセサ**
    - 最小メトリックのネクストホップルータ。サクセサルートはトポロジテーブルとルーティングテーブルに格納される
  - **フィージブルサクセサ**
    - サクセサのバックアップとなるネクストホップルータ。フィージブルサクセサルートはトポロジテーブルにのみ格納される
  - 状態
    - `Passive状態`: 正常で利用可能な状態
    - `Active状態`: 再計算を実行中で、利用不可能な状態
      - サクセサルートやフィージブルサクセサルートはPassive状態の時に機能する. Active状態は利用不可能.
    - サクセサルートやフィージブルサクセサルートがネイバーテーブルに格納されることはない 

[アドバタイズディスタンスとフィージブルディスタンスのイメージ図]

![Alt Text](https://github.com/yhidetoshi/Pictures/raw/master/Network_Study/eigrp-ad-fd.png)

- アドバタイズドディスタンス
  - ネクストホップルータから宛先ネットワークまでのメトリック値
- フィージブルディスタンス
  - ローカルルータから宛先ネットワークまでのメトリック値
  
- **フィージブルディスタンス(FD)が最小の経路がサクセサとなる**
- **FDはルーティングテーブルのメトリック値として格納される**
- フィージブルサクセサが存在しなければ、その宛先ネットワークへの経路が他に存在しないを確認するためにクエリパケットを全てのネイバーにマルチキャストで送信して再計算する
  



